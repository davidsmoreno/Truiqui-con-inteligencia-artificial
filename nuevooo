import random

jugadorp=''
jugadorm=''
vacio=''
m=['','','','','','','','','']



def elegir_X_o_O(jugadorp,jugadorm):
	jugadorp=raw_input("quiere ser X o O")
	while jugadorp not in ('X','O'):
		print ("elija otra vez")
		jugadorp=raw_input("quiere ser X o O")
	if jugadorp=='X':
		print "es su turno"
		jugadorm='O'
	else:
		print "es el turno de la maquina"
		jugadorm='X'
	return jugadorm,jugadorp

def quienvaprimero():
	turno=None
	while turno not in ('Si','No'):
		turno=raw_input("quiere comenzar en primer lugar")
		if turno=='Si':
			return 1
		elif turno=='No':
			return 0
		else:
			print "es invalido"

def dibujartablero(tablero):
    
   	print tablero[0]  ,"|",tablero[1],"|",tablero[2]
	print "----------"
	print tablero[3]  ,"|",tablero[4],"|",tablero[5]
	print "----------"
	print tablero[6]  ,"|",tablero[7],"|",tablero[8]

def jugador_p1(jugadorp, jugadorm, m):
    while gana(jugadorp, jugadorm, m) is None:
        move = jugadorp_mueve(jugadorp,m)
        m[int(move)] = jugadorp
        dibujartablero(m)
        if gana(jugadorp, jugadorm, m) != None:
            break
        else:
            pass
        print "bueno"
        jugada = jugadorm_mueve(jugadorp,jugadorm,m)
        print jugada
        m[int(jugada)] = jugadorm
        dibujartablero(m)
    q = gana(jugadorp, jugadorm, m)
    if q == 1:
        print "ganaste"
    elif q == 0:
        print "perdiste"
    else:
        print "es empate"

def jugador_m1(jugadorp,jugarorm,m):
    while not gana(jugadorp,jugarorm,m):
        print "la rata"
        jugada =jugadorm_mueve(jugadorp,jugarorm,m)
        print jugada
        m[jugada] = jugadorm
        dibujartablero(m)
        if gana(jugadorp,jugarorm,m) != None:
            break
        else:
            pass
        move = jugadorp_mueve(jugadorp,m)
        m[int(move)] = jugadorp
        dibujartablero(m)
    q = gana(jugadorp, jugadorm, m)
    if q == 1:
        print "ganaste"
    elif q == 0:
        print "perdiste"
    else:
        print "empate"





def gana(jugadorp,jugadorm,m):
	mdeganar=((0,1,2),(3,4,5),(6,7,8),(0,3,6),(1,4,7),(2,5,8),(0,4,8),(2,4,6))
	for i in mdeganar:
		if m[i[0]]==m[i[1]]==m[i[2]] !=vacio:
			ganador=m[i[0]]
			if ganador==jugadorp:
				return 1
			elif ganador==jugadorm:
				return 0
			if vacio not in m:
				return 'Empate'
	if vacio not in m:
		return 'Empate'
	return None




		

def jugadorp_mueve(jugadorp,m):
	a=raw_input("donde quiere moverlo del 0 al 8")
	while True:
		a=raw_input("elija del 0 al 8")
		if m[int(a)]!=vacio:
			a=raw_input("elija del 0 al 8")
		else:
			return int(a)

def jugadorm_mueve(jugadorp,jugadorm,m):
	mejoresj=[4,0,2,6,8]
	lista=[]
	for i in range(9):
		if m[i]==vacio:
			lista.append(i)
	for i in lista:
		m[i]=jugadorm
		if gana(jugadorp,jugadorm,m)== 0:
			return i
		m[i]=vacio
	for i in lista:
		m[i]=jugadorp
		if gana(jugadorp,jugadorm,m)== 1:
			return i
		m[i]=vacio

	return int(lista[random.randrange(len(lista))])

def ejecutable(jugadorp,jugadorm,m):

	a=elegir_X_o_O(jugadorp,jugadorm)
	jugadorp=a[0]
	jugadorm=a[1]
	b=quienvaprimero()
	if b==1:
		print "vas de primero"
		dibujartablero(m)
		jugador_p1(jugadorp,jugadorm,m)
	elif b==0:
		print "la maquina va primero"
		dibujartablero(m)
		jugador_m1(jugadorp,jugarorm,m)
	else:
		pass
		
ejecutable(jugadorp,jugadorm,m)

		
		
	





		
		

